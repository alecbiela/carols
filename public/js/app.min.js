/*! carols 27-11-2024 */
window.onload=(()=>{let a,d=parseInt(localStorage.getItem("currentsong"))||1,n=(localStorage.setItem("currentsong",d),{x0:0,y0:0,x1:0,y1:0}),c=!1;var e;let r=e=>{d=e.target.getAttribute("data-song-id"),l(d),t()},s=()=>{var e=d-1;l(e)},o=()=>{var e=d+1;l(e)},t=()=>{document.getElementById("navigation_wrapper").classList.toggle("nav-open")},i=(document.getElementById("song_select").addEventListener("click",t),document.getElementById("next_button").addEventListener("click",o),document.getElementById("prev_button").addEventListener("click",s),()=>new Promise(t=>{setTimeout(()=>{var e=document.querySelector(".song.exiting");e.classList.contains("left")?(e.classList.add("right"),e.classList.remove("left")):(e.classList.remove("right"),e.classList.add("left")),e.classList.add("staging"),e.classList.remove("exiting"),c=!1,t("done")},250)})),l=t=>{if(!0!==c){c=!0;var n=d,s=(d=parseInt(t),localStorage.setItem("currentsong",d),a[t-1].id+". "+a[t-1].name),o=a[t-1].lyrics,r=document.querySelector(".song.current");let e;(e=n>d?document.querySelector(".song.staging.left"):document.querySelector(".song.staging.right")).getElementsByClassName("song-title")[0].textContent=s,e.getElementsByClassName("song-lyrics")[0].innerHTML=o,r.classList.remove("current"),e.classList.remove("staging","right","left"),r.classList.add("exiting",n>d?"right":"left"),e.classList.add("current"),(async()=>{await i()})(),[...document.querySelectorAll(".song-button")].forEach(e=>{e.classList.remove("current-song","prev-song"),parseInt(e.getAttribute("data-song-id"))<t&&e.classList.add("prev-song")}),document.querySelector('.song-button[data-song-id="'+t+'"]').classList.add("current-song"),document.querySelector(".current-song").scrollIntoView(),window.scroll({top:0,left:0,behavior:"smooth"}),g()}},g=()=>{(1===d?(document.getElementById("prev_button").setAttribute("disabled","disabled"),document.getElementById("next_button")):(d===a.length?document.getElementById("next_button").setAttribute("disabled","disabled"):document.getElementById("next_button").removeAttribute("disabled"),document.getElementById("prev_button"))).removeAttribute("disabled")},u=(window.addEventListener("touchstart",e=>{n.x0=e.changedTouches[0].screenX,n.y0=e.changedTouches[0].screenY}),window.addEventListener("touchend",e=>{n.x1=e.changedTouches[0].screenX,n.y1=e.changedTouches[0].screenY,u()}),()=>{var e=n.x1-n.x0,t=n.y1-n.y0;Math.abs(t)<100&&(50<e&&1!==d?s():e<-50&&d!==a.length&&o())});(e=new XMLHttpRequest).onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=(a=JSON.parse(this.responseText).songs)[d-1].id+". "+a[d-1].name,t=a[d-1].lyrics;document.querySelector(".song.current .song-title").textContent=e,document.querySelector(".song.current .song-lyrics").innerHTML=t,1===a.length&&(document.getElementById("next_button").setAttribute("disabled","disabled"),document.getElementById("prev_button").setAttribute("disabled","disabled"));for(var n=0;n<a.length;n++){var s=document.createElement("li"),o=(s.classList="song-nav-item",document.createElement("button"));o.setAttribute("type","button"),o.setAttribute("data-song-id",a[n].id),o.textContent=a[n].id+". "+a[n].name,o.addEventListener("click",r),d>a[n].id?o.classList="song-button prev-song":d<a[n].id?o.classList="song-button":o.classList="song-button current-song",s.appendChild(o),document.querySelector(".song-navigation").appendChild(s)}document.querySelector(".current-song").scrollIntoView(),g()}},e.open("GET","data/songs.json",!0),e.send()})();