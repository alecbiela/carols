/*! carols 03-12-2024 */
import Alpine from"https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/module.esm.min.js";let songs,currentSong=parseInt(localStorage.getItem("currentsong"))||1,SWIPE_THRESHOLD=(localStorage.setItem("currentsong",currentSong),50),touch={x0:0,y0:0,x1:0,y1:0},TRANSITION_IN_PROGRESS=!1,loadSongs=()=>{var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=(songs=JSON.parse(this.responseText).songs)[currentSong-1].id+". "+songs[currentSong-1].name,e=songs[currentSong-1].lyrics;document.querySelector(".song.current .song-title").textContent=t,document.querySelector(".song.current .song-lyrics").innerHTML=e,1===songs.length&&(document.getElementById("next_button").setAttribute("disabled","disabled"),document.getElementById("prev_button").setAttribute("disabled","disabled"));for(let t=0;t<songs.length;t++){var n=document.createElement("li"),s=(n.classList="song-nav-item",document.createElement("button"));s.setAttribute("type","button"),s.setAttribute("data-song-id",songs[t].id),s.textContent=songs[t].id+". "+songs[t].name,s.addEventListener("click",songButtonClick),currentSong>songs[t].id?s.classList="song-button prev-song":currentSong<songs[t].id?s.classList="song-button":s.classList="song-button current-song",n.appendChild(s),document.querySelector(".song-navigation").appendChild(n)}document.querySelector(".current-song").scrollIntoView(),checkArrows()}},t.open("GET","data/songs.json",!0),t.send()},songButtonClick=t=>{currentSong=t.target.getAttribute("data-song-id"),loadSong(currentSong),toggleNavMenu()},prevButtonClick=()=>{var t=currentSong-1;loadSong(t)},nextButtonClick=()=>{var t=currentSong+1;loadSong(t)},toggleNavMenu=()=>{document.getElementById("navigation_wrapper").classList.toggle("nav-open")},replaceStagingSong=(document.getElementById("song_select").addEventListener("click",toggleNavMenu),document.getElementById("next_button").addEventListener("click",nextButtonClick),document.getElementById("prev_button").addEventListener("click",prevButtonClick),()=>new Promise(e=>{setTimeout(()=>{var t=document.querySelector(".song.exiting");t.classList.contains("left")?(t.classList.add("right"),t.classList.remove("left")):(t.classList.remove("right"),t.classList.add("left")),t.classList.add("staging"),t.classList.remove("exiting"),TRANSITION_IN_PROGRESS=!1,e("done")},250)})),resetStaging=async()=>{await replaceStagingSong()},loadSong=e=>{if(!0!==TRANSITION_IN_PROGRESS){TRANSITION_IN_PROGRESS=!0;var n=currentSong,s=(currentSong=parseInt(e),localStorage.setItem("currentsong",currentSong),songs[e-1].id+". "+songs[e-1].name),o=songs[e-1].lyrics,r=document.querySelector(".song.current");let t;(t=n>currentSong?document.querySelector(".song.staging.left"):document.querySelector(".song.staging.right")).getElementsByClassName("song-title")[0].textContent=s,t.getElementsByClassName("song-lyrics")[0].innerHTML=o,r.classList.remove("current"),t.classList.remove("staging","right","left"),r.classList.add("exiting",n>currentSong?"right":"left"),t.classList.add("current"),resetStaging(),[...document.querySelectorAll(".song-button")].forEach(t=>{t.classList.remove("current-song","prev-song"),parseInt(t.getAttribute("data-song-id"))<e&&t.classList.add("prev-song")}),document.querySelector('.song-button[data-song-id="'+e+'"]').classList.add("current-song"),document.querySelector(".current-song").scrollIntoView(),window.scroll({top:0,left:0,behavior:"smooth"}),checkArrows()}},checkArrows=()=>{(1===currentSong?(document.getElementById("prev_button").setAttribute("disabled","disabled"),document.getElementById("next_button")):(currentSong===songs.length?document.getElementById("next_button").setAttribute("disabled","disabled"):document.getElementById("next_button").removeAttribute("disabled"),document.getElementById("prev_button"))).removeAttribute("disabled")},handleGesture=()=>{var t=touch.x1-touch.x0,e=touch.y1-touch.y0;Math.abs(e)<2*SWIPE_THRESHOLD&&(t>SWIPE_THRESHOLD&&1!==currentSong?prevButtonClick():t<-SWIPE_THRESHOLD&&currentSong!==songs.length&&nextButtonClick())};Alpine.data("app",()=>({currentSong:currentSong,songs:songs,loadSongs:loadSongs,init(){window.addEventListener("touchstart",t=>{touch.x0=t.changedTouches[0].screenX,touch.y0=t.changedTouches[0].screenY}),window.addEventListener("touchend",t=>{touch.x1=t.changedTouches[0].screenX,touch.y1=t.changedTouches[0].screenY,handleGesture()})}})),Alpine.start();
//# sourceMappingURL=app.min.js.map